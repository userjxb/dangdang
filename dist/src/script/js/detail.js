"use strict";var _createClass=function(){function e(i,t){for(var s=0;s<t.length;s++){var e=t[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}return function(i,t,s){return t&&e(i.prototype,t),s&&e(i,s),i}}();function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}!function(i){i(".topbar").load("header.html .topbar"),i(".logo-line").load("header.html .logo-line"),i(".nav-top").load("header.html .nav-top")}(jQuery),function(i){function t(){_classCallCheck(this,t),this.timer=null,this.$account=i.cookie("account"),this.phpUrl="http://10.31.163.63/dangdang/php/"}(new(_createClass(t,[{key:"init",value:function(){var i=this;this.timer=setTimeout(function(){i.showInfo(),clearTimeout(i.timer)},150),this.getPetName(),this.exit()}},{key:"showInfo",value:function(){this.$account?(i(".pleaseLogin").hide(),i(".welcomeWord").find("span").html(this.$account),i(".welcomeWord").show()):(i(".pleaseLogin").show(),i(".welcomeWord").hide())}},{key:"getPetName",value:function(){var t=this;i.ajax({type:"get",url:this.phpUrl+"getPetName.php",data:{account:this.$account},dataType:"json"}).done(function(i){t.$account=i.username})}},{key:"exit",value:function(){i(".header").on("click",".exit",function(){confirm("你确定要退出吗？")&&(i.cookie("account","null",{expires:-1}),i(".pleaseLogin").show(),i(".welcomeWord").hide())})}}]),t)).init()}(jQuery),function(h){function i(){_classCallCheck(this,i),this.$spic=h(".spic"),this.$bpic=h(".bpic"),this.$picList=h(".pic-group ul"),this.$title=h(".show-info .title span"),this.$description=h(".show-info .description"),this.$msg=h(".show-info .msg"),this.$price=h(".show-info .price"),this.$phpUrl="http://10.31.163.63/dangdang/php/"}(new(_createClass(i,[{key:"init",value:function(){var n=this,i=location.search.substring(1).split("=")[1];h.ajax({url:this.$phpUrl+"oneData.php",data:{sid:i},dataType:"json",success:function(i){n.$spic.find("img").attr("src",i.picurl),n.$spic.find("img").attr("sid",i.sid),n.$bpic.attr("src",i.picurl),n.$title.html(i.name),n.$description.html(i.description),n.$msg.find(".author span").html(i.author),n.$msg.find(".press span").html(i.press),n.$msg.find(".press-time span").html(i.presstime),n.$price.find(".new-price .p span").html(i.newprice),n.$price.find(".old-price span").html(i.oldprice),i.ebookprice?n.$price.find(".ebook-price .p span").html(i.ebookprice):n.$price.find(".ebook-price").html("");var s="",t=i.piclist.split(",");""!=t[0]&&(h.each(t,function(i,t){s+='<li><a href="javascript:;"><img src='+t+"></a></li>"}),n.$picList.html(s));var e=n.$picList.find("li").outerWidth(!0);n.$picList.width(e*t.length)}})}}]),i)).init()}(jQuery),function(e){function i(){_classCallCheck(this,i),this.$spic=e(".spic"),this.$sf=e(".spic .sf"),this.$bpic=e(".bpic"),this.$bf=e(".bf"),this.$imgUl=e(".pic-group ul"),this.$prev=e(".pic-group .prev"),this.$next=e(".pic-group .next")}(new(_createClass(i,[{key:"init",value:function(){var s=this;this.$spic.hover(function(){s.over()},function(){s.out()}),this.showlength=5,this.$prev.hide(),this.$prev.on("click",function(){s.prev()}),this.$next.on("click",function(){s.next()}),this.$imgUl.on("click","li",function(i){var t=e(i.target);s.liClick(t)})}},{key:"over",value:function(){var t=this;this.bili=this.$bpic.width()/this.$spic.width(),this.$sf.width(this.$bf.width()/this.bili),this.$sf.height(this.$bf.height()/this.bili),this.$sf.show(),this.$bf.show(),this.$spic.on("mousemove",function(i){t.move(i)})}},{key:"out",value:function(){this.$sf.hide(),this.$bf.hide()}},{key:"move",value:function(i){var t=i.pageX-this.$spic.offset().left-this.$sf.width()/2,s=i.pageY-this.$spic.offset().top-this.$sf.height()/2;t<=0?t=0:t>=this.$spic.width()-this.$sf.width()&&(t=this.$spic.width()-this.$sf.width()),s<=0?s=0:s>=this.$spic.height()-this.$sf.height()&&(s=this.$spic.height()-this.$sf.height()),this.$sf.css({left:t,top:s}),this.$bpic.css({left:-t*this.bili,top:-s*this.bili})}},{key:"liClick",value:function(i){var t=i.attr("src");t=t.replace(/x/g,"u"),this.$spic.find("img").attr("src",t),this.$bpic.attr("src",t)}},{key:"prev",value:function(){var i=e(".pic-group ul li");5<this.showlength&&(this.showlength--,this.$next.show()),5==this.showlength&&this.$prev.hide(),this.$imgUl.animate({left:-(this.showlength-5)*i.eq(0).outerWidth(!0)})}},{key:"next",value:function(){var i=e(".pic-group ul li");i.length>this.showlength&&(this.showlength++,this.$prev.show()),i.length<=this.showlength&&this.$next.hide(),this.$imgUl.animate({left:-(this.showlength-5)*i.eq(0).outerWidth(!0)})}}]),i)).init()}(jQuery),function(i){function t(){_classCallCheck(this,t),this.$more=i("#more"),this.$less=i("#less"),this.$num=i(".num input")}(new(_createClass(t,[{key:"init",value:function(){var i=this;this.$more.on("click",function(){i.more()}),this.$less.on("click",function(){i.less()}),this.$num.on("input",function(){i.input()})}},{key:"more",value:function(){var i=this.$num.val();99<++i&&(i=99),this.$num.val(i)}},{key:"less",value:function(){var i=this.$num.val();--i<1&&(i=1),this.$num.val(i)}},{key:"input",value:function(){var i=parseInt(this.$num.val());/^\d+$/g.test(i)?99<=i?this.$num.val(99):i<=0?this.$num.val(1):this.$num.val(i):this.$num.val(1)}}]),t)).init()}(jQuery),function(s){function i(){_classCallCheck(this,i),this.$addBtn=s("#add-to-cart"),this.$count=s(".num input"),this.arrsid=[],this.arrnum=[],this.amount=0,this.timer=null}(new(_createClass(i,[{key:"init",value:function(){var i=this;this.timer=setTimeout(function(){s.cookie("amount")&&(i.amount=parseInt(s.cookie("amount"))),s(".shopping-cart b").html(i.amount),clearTimeout(i.timer)},100),this.$addBtn.on("click",function(){i.btnClick(),s(".shopping-cart b").html(i.amount)})}},{key:"cookietoarray",value:function(){s.cookie("cookiesid")&&s.cookie("cookienum")&&(this.arrsid=s.cookie("cookiesid").split(","),this.arrnum=s.cookie("cookienum").split(","))}},{key:"btnClick",value:function(){var i=this.$addBtn.parents(".detail").find("#smallpic").attr("sid");if(this.cookietoarray(),-1!=s.inArray(i,this.arrsid)){var t=parseInt(this.arrnum[s.inArray(i,this.arrsid)])+parseInt(this.$count.val());this.arrnum[s.inArray(i,this.arrsid)]=t,s.cookie("cookienum",this.arrnum.toString(),{expires:7}),this.amount+=parseInt(this.$count.val()),s.cookie("amount",this.amount,{expires:7})}else this.arrsid.push(i),s.cookie("cookiesid",this.arrsid.toString(),{expires:7}),this.arrnum.push(this.$count.val()),s.cookie("cookienum",this.arrnum.toString(),{expires:7}),this.amount+=parseInt(this.$count.val()),s.cookie("amount",this.amount,{expires:7})}}]),i)).init()}(jQuery);